<nav *ngIf="this.srv.pers" class="fixed-bottom">
  <div class="d-flex w-100 justify-content-end px-2 py-2">
    <!-- Назад -->
    <button *ngIf="!isEditMode" mat-icon-button (click)="goBack()" class="mx-2">
      <img src="assets/icons/left.png" *ngIf="!this.srv.isGlobalTaskView" class="img-fluid"
        [ngStyle]="{'object-fit': 'contain', 'height':'2.5em'}">
    </button>
    <!-- Редактировать -->
    <button mat-icon-button (click)="saveData()">
      <img *ngIf="!isEditMode" src="assets/icons/edit.png" class="img-fluid"
        [ngStyle]="{'object-fit': 'contain', 'height':'3em'}">
      <img *ngIf="isEditMode" src="assets/icons/create.png" class="img-fluid"
        [ngStyle]="{'object-fit': 'contain', 'height':'3em'}">
    </button>
  </div>
</nav>

<!-- Модальное окно - добавление навыка -->
<div mdbModal #addAb="mdbModal" class="modal fade" role="dialog" aria-hidden="true" aria-labelledby="myBasicModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title w-100">Добавить навык</h4>
      </div>
      <div class="modal-body">
        <mat-form-field class="w-100">
          <input #addAbImp matInput autocomplete="off" placeholder="Название" [(ngModel)]="newAbil" name="newAbil">
          {{addAbImp.focus()}}
        </mat-form-field>
      </div>
      <div class="modal-footer">
        <button aria-label="Close" (click)="addAb.hide()" mat-button>Отмена</button>
        <button (click)="addAb.hide(); addAbil();" mat-stroked-button color="accent">ОК</button>
        <!-- routerLink="./" fragment="abs" -->
      </div>
    </div>
  </div>
</div>

<!-- Просмотр -->
<div class="container pt-2 pb-4" *ngIf="this.srv.pers && charact && !isEditMode">
  <form class="pb-4">
    <!-- Картинка -->
    <div *ngIf="charact.image" fxLayout="row" fxLayoutAlign="center center" class="p-2">
      <img src="{{charact.image}}" class="img-fluid" [ngStyle]="{'object-fit': 'contain', 'height': '25vh'}">
    </div>
    <h4 class="text-center">{{charact.name}} ({{charact.rang.name}})</h4>
    <mat-progress-bar class="myprogr" color="accent" mode="determinate" value="{{charact.progressValue}}">
    </mat-progress-bar>
    <!-- Описание -->
    <div *ngIf="charact.descr" class="text-center pt-2">
      <i>
        {{charact.descr}}
      </i>
    </div>
    <!-- Навыки -->
    <ul class="list-group p-0 pt-1" *ngIf="charact.abilities.length>0">
      <li *ngFor="let ab of charact.abilities" class="list-group-item px-0 py-1 border-0">
        <a class="align-self-center w-100 text-primary" (click)="showAbility(ab)">
          <div class="d-flex">
            <div class="flex-grow-1 text-left align-self-baseline">
              <h6>{{ab.name}}</h6>
            </div>
            <div class="text-right align-self-baseline">
              <h6>{{ab.rang.name}}</h6>
            </div>
          </div>
        </a>
        <mat-progress-bar class="myprogr" color="accent" mode="determinate" value="{{ab.progressValue}}">
        </mat-progress-bar>
      </li>
    </ul>
  </form>
  <br>
  <br>
</div>
<!-- Редактирование -->
<div class="container pt-2 pb-4" *ngIf="this.srv.pers && charact && isEditMode">
  <form class="pb-4">
    <!-- Картинка -->
    <!-- <div class="md-form text-center" *ngIf="charact.image">
      <img src="{{charact.image}}" class="img-fluid" [ngStyle]="{'object-fit': 'contain', 'height': '25vh'}">
    </div> -->
    <!-- Название -->
    <mat-form-field class="w-100">
      <input matInput autocomplete="off" placeholder="Название" [(ngModel)]="charact.name" name="charact.name">
    </mat-form-field>

    <!-- Изображение -->
    <mat-form-field class="w-100">
      <input matInput autocomplete="off" placeholder="Изображение" [(ngModel)]="charact.image" name="charact.image">
    </mat-form-field>

    <!-- Начальное значение -->
    <mat-form-field class="w-100">
      <mat-label>Начальное значение</mat-label>
      <mat-select [(ngModel)]="charact.startRang.val" name="food">
        <mat-option *ngFor="let rang of rangse" [value]="rang.val">
          {{rang.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Описание -->
    <mat-form-field class="w-100">
      <input matInput autocomplete="off" placeholder="Описание" [(ngModel)]="charact.descr" name="charact.descr">
    </mat-form-field>

    <!-- Навыки -->
    <!-- Добавить навык -->
    <div fxLayout="row" fxLayoutAlign="space-between center">
      <h5>Навыки:</h5>
      <button class="icon-small" (click)="addAb.show();" mat-icon-button>
        <img src="assets/icons/create.png" *ngIf="!this.srv.isGlobalTaskView" class="img-fluid">
      </button>
    </div>
    <!-- Навыки -->
    <mat-list id="abs" *ngIf="charact.abilities.length>0">
      <div mat-list-item *ngFor="let ab of charact.abilities">
        <div class="d-flex">
          <div class="flex-grow-1 align-self-center">
            <a>
              {{ab.name}}
            </a>
          </div>
          <div class="btn-group btn-group-sm" role="group" aria-label="Действия">
            <!-- Удалить -->
            <button class="icon-small" (click)="delAbil(ab.id)" mat-icon-button>
              <img src="assets/icons/del.png" *ngIf="!this.srv.isGlobalTaskView" class="img-fluid">
            </button>
          </div>
        </div>
      </div>
    </mat-list>
  </form>
  <br>
  <br>
</div>